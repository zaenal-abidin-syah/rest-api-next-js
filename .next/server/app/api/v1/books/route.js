"use strict";(()=>{var e={};e.id=98,e.ids=[98],e.modules={846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1421:e=>{e.exports=require("node:child_process")},1455:e=>{e.exports=require("node:fs/promises")},1708:e=>{e.exports=require("node:process")},3024:e=>{e.exports=require("node:fs")},3033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{e.exports=require("path")},4870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4990:(e,r,t)=>{t.r(r),t.d(r,{createBook:()=>s,deleteBook:()=>u,getAllBooks:()=>a,getBookById:()=>i,updateBook:()=>n});var o=t(1937);let s=async e=>{let{title:r,author:t,publisher:s,isbn:i,published_year:a,stock:n}=e;console.log({data:e});try{if(!r)throw Error("Missing required field: title");if(!t)throw Error("Missing required field: author");if(!n)throw Error("Missing required field: stock");return await o.A.book.create({data:{title:r,author:t,publisher:s||void 0,isbn:i||void 0,published_year:a||void 0,stock:n}})}catch(e){throw Error("Error creating book")}},i=async e=>{try{let r=await o.A.book.findUnique({where:{id:e}});if(!r)throw Error("Book not found");return r}catch(e){throw Error(e.message)}},a=async()=>{try{return await o.A.book.findMany()}catch(e){throw Error("Error fetching books")}},n=async(e,r="PUT")=>{try{console.log({data:e});let{id:t,...s}=e;if(!t)throw Error("Book ID is required.");let i={};if("PUT"===r){for(let e of["title","author","publisher","isbn","published_year","stock"])if(!(e in s))throw Error(`Missing required field for PUT: ${e}`);i=s}else if("PATCH"===r){if(0===Object.keys(s).length)throw Error("No fields provided for PATCH.");i=s}else throw Error(`Unsupported method: ${r}`);return await o.A.book.update({where:{id:t},data:i})}catch(r){if("P2025"===r.code)throw Error(`Book with id ${e.id} not found.`);throw r}},u=async e=>{try{return await o.A.book.delete({where:{id:e}})}catch(e){throw Error("Book not found")}}},5087:(e,r,t)=>{t.r(r),t.d(r,{patchFetch:()=>x,routeModule:()=>h,serverHooks:()=>k,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>w});var o={};t.r(o),t.d(o,{GET:()=>l,POST:()=>c});var s=t(6559),i=t(8088),a=t(7719);let{NextResponse:n}=t(2190),{getAllBooks:u,createBook:p}=t(4990),{validateToken:d}=t(8682),l=async e=>{try{let r=e.headers.get("Authorization");await d(r.split(" ")[1]);let t=await u();return n.json({message:"successfully get all books",data:t},{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return n.json({message:e.message},{status:400,headers:{"Content-Type":"application/json"}})}},c=async e=>{try{let r=e.headers.get("Authorization");await d(r.split(" ")[1]);let t=await e.json();return await p(t),n.json({message:"create books successfully"},{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return n.json({message:e.message},{status:400,headers:{"Content-Type":"application/json"}})}},h=new s.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/v1/books/route",pathname:"/api/v1/books",filename:"route",bundlePath:"app/api/v1/books/route"},resolvedPagePath:"/home/zaens/Codes/rest-api-with-nextjs/app/api/v1/books/route.js",nextConfigOutput:"",userland:o}),{workAsyncStorage:f,workUnitAsyncStorage:w,serverHooks:k}=h;function x(){return(0,a.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:w})}},5511:e=>{e.exports=require("crypto")},6698:e=>{e.exports=require("node:async_hooks")},6760:e=>{e.exports=require("node:path")},7066:e=>{e.exports=require("node:tty")},7598:e=>{e.exports=require("node:crypto")},7910:e=>{e.exports=require("stream")},7975:e=>{e.exports=require("node:util")},8161:e=>{e.exports=require("node:os")},8354:e=>{e.exports=require("util")},8474:e=>{e.exports=require("node:events")},8682:(e,r,t)=>{t.r(r),t.d(r,{validateToken:()=>i});var o=t(5586),s=t.n(o);let i=e=>{try{if(!e)throw Error("Token is required");let r=s().verify(e,process.env.JWT_SECRET,(e,r)=>{if(e)throw Error(e.message);return r});if(r.exp<Math.floor(Date.now()/1e3))throw Error("Token expired");return r}catch(e){throw Error(e.message)}}},9021:e=>{e.exports=require("fs")},9294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9428:e=>{e.exports=require("buffer")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[922,205,629],()=>t(5087));module.exports=o})();