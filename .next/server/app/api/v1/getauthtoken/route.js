"use strict";(()=>{var e={};e.id=765,e.ids=[765],e.modules={290:(e,r,t)=>{t.r(r),t.d(r,{patchFetch:()=>m,routeModule:()=>w,serverHooks:()=>g,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>f});var s={};t.r(s),t.d(s,{GET:()=>h});var o=t(6559),a=t(8088),n=t(7719),i=t(5586),u=t.n(i),p=t(5663),d=t(6275);let c=async(e,r)=>{try{let t=await (0,d.getUserByEmail)(e);if(!t||!await (0,p.UD)(r,t.password))throw Error("Invalid Credentials");let s=Math.floor(Date.now()/1e3),o=u().sign({username:t.username,email:t.email,password:t.password,exp:s+3600},process.env.JWT_SECRET);return await prisma.token.upsert({where:{user_id:t.id},create:{user_id:t.id,token:o},update:{token:o}}),o}catch(e){throw Error(e.message)}};var l=t(2190);let h=async e=>{try{let r=e.headers.get("Authorization"),t=JSON.stringify(r,null,2).split(" ")[1],[s,o]=Buffer.from(t,"base64").toString("utf-8").split(":"),a=await c(s,o);return l.NextResponse.json({message:"Token generated successfully",token:a},{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return l.NextResponse.json({message:e.message},{status:400,headers:{"Content-Type":"application/json"}})}},w=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/v1/getauthtoken/route",pathname:"/api/v1/getauthtoken",filename:"route",bundlePath:"app/api/v1/getauthtoken/route"},resolvedPagePath:"/home/zaens/Codes/rest-api-with-nextjs/app/api/v1/getauthtoken/route.js",nextConfigOutput:"",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:f,serverHooks:g}=w;function m(){return(0,n.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:f})}},846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1421:e=>{e.exports=require("node:child_process")},1455:e=>{e.exports=require("node:fs/promises")},1708:e=>{e.exports=require("node:process")},3024:e=>{e.exports=require("node:fs")},3033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{e.exports=require("path")},4870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5511:e=>{e.exports=require("crypto")},6275:(e,r,t)=>{t.r(r),t.d(r,{createUser:()=>a,getUserByEmail:()=>i,getUserById:()=>n,getUserByUsername:()=>u});var s=t(1937),o=t(5663);let a=async e=>{try{let{email:r,password:t,username:a,fullname:n}=e;if(await s.A.user.findUnique({where:{username:a}}))throw Error("User already exists");if(await s.A.user.findUnique({where:{email:r}}))throw Error("Email already exists");let i=await (0,o.tW)(t,10);return await s.A.user.create({data:{email:r,password:i,username:a,fullname:n??void 0}})}catch(e){throw console.error("Error creating user:",e),Error(e.message)}},n=async e=>{try{let r=await s.A.user.findUnique({where:{id:e}});if(!r)throw Error("User not found");return r}catch(e){throw Error(e.message)}},i=async e=>{try{let r=await s.A.user.findUnique({where:{email:e}});if(!r)throw Error("User not found");return r}catch(e){throw Error(e.message)}},u=async e=>{try{let r=await s.A.user.findUnique({where:{username:e}});if(!r)throw Error("User not found");return r}catch(e){throw Error(e.message)}}},6698:e=>{e.exports=require("node:async_hooks")},6760:e=>{e.exports=require("node:path")},7066:e=>{e.exports=require("node:tty")},7598:e=>{e.exports=require("node:crypto")},7910:e=>{e.exports=require("stream")},7975:e=>{e.exports=require("node:util")},8161:e=>{e.exports=require("node:os")},8354:e=>{e.exports=require("util")},8474:e=>{e.exports=require("node:events")},9021:e=>{e.exports=require("fs")},9294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9428:e=>{e.exports=require("buffer")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[922,205,663,629],()=>t(290));module.exports=s})();